exports.id=653,exports.ids=[653],exports.modules={6552:(e,t,n)=>{Promise.resolve().then(n.bind(n,725)),Promise.resolve().then(n.t.bind(n,9404,23))},1372:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2994,23)),Promise.resolve().then(n.t.bind(n,6114,23)),Promise.resolve().then(n.t.bind(n,9727,23)),Promise.resolve().then(n.t.bind(n,9671,23)),Promise.resolve().then(n.t.bind(n,1868,23)),Promise.resolve().then(n.t.bind(n,4759,23))},660:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var r=n(326),a=n(7577),o=n(3353),l=n.n(o);let s=(0,a.createContext)(null);function i(){return function(){let e=(0,a.useContext)(s);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}().map}s.Provider;let d=l()(async()=>{},{loadableGenerated:{modules:["app/model1-heatmap/page.tsx -> react-leaflet"]},ssr:!1}),c=l()(async()=>{},{loadableGenerated:{modules:["app/model1-heatmap/page.tsx -> react-leaflet"]},ssr:!1}),u=l()(async()=>{},{loadableGenerated:{modules:["app/model1-heatmap/page.tsx -> react-leaflet"]},ssr:!1}),h=l()(async()=>{},{loadableGenerated:{modules:["app/model1-heatmap/page.tsx -> react-leaflet"]},ssr:!1});function m(e){let t=e?.AddressInfo?.Latitude,n=e?.AddressInfo?.Longitude;if("number"!=typeof t||"number"!=typeof n)return null;let r=Array.isArray(e?.Connections)?e.Connections:[],a=r.length,o=r.reduce((e,t)=>"number"==typeof t?.PowerKW&&t.PowerKW>e?t.PowerKW:e,0)||0,l=e?.autodun?.score;return{lat:t,lon:n,name:e?.AddressInfo?.Title??null,addr:e?.AddressInfo?.AddressLine1??null,postcode:e?.AddressInfo?.Postcode??null,connectors:a,maxPowerKw:o,score:"number"==typeof l?l:.6*Math.log(1+(a||0))+o/350*.3+.1,raw:e}}let f=({onReady:e})=>{let t=i();return(0,a.useEffect)(()=>{e(t)},[t,e]),null},p=({onLocate:e})=>{let[t,n]=(0,a.useState)(""),[o,l]=(0,a.useState)(!1),s=async()=>{if(t.trim()){l(!0);try{let n=new URL("https://nominatim.openstreetmap.org/search");n.searchParams.set("format","json"),n.searchParams.set("q",t),n.searchParams.set("addressdetails","1"),n.searchParams.set("limit","1"),n.searchParams.set("countrycodes","gb");let r=await fetch(n.toString(),{headers:{Accept:"application/json"}}),a=await r.json();if(a?.length){let t=a[0],n=parseFloat(t.lat),r=parseFloat(t.lon);e({lat:n,lng:r},13)}else alert("No results for that place/postcode.")}catch(e){console.error(e),alert("Search failed. Try again.")}finally{l(!1)}}};return(0,r.jsxs)("div",{className:"z-[1000] absolute top-4 left-4 bg-black/80 text-white rounded-xl px-3 py-3 flex flex-wrap items-center gap-2",children:[r.jsx("button",{onClick:()=>e(null),className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20",children:"My location"}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20",children:"Reset view"}),r.jsx("button",{id:"markersBtn",className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20",children:"Markers"}),r.jsx("button",{id:"heatBtn",className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20",children:"Heatmap"}),r.jsx("input",{value:t,onChange:e=>n(e.target.value),placeholder:"Search postcode or area (e.g. EC1A)",className:"px-3 py-2 rounded-lg bg-white/10 outline-none w-80"}),r.jsx("button",{onClick:s,disabled:o,className:"px-3 py-2 rounded-lg bg-emerald-500 text-black hover:bg-emerald-400",children:o?"Searching…":"Search"})]})},x=({setStations:e,setHeatData:t,zoom:n,showMarkers:r,showHeat:o,onToggleWires:l})=>{let s=i(),d=function(e,t){let n=(0,a.useRef)(null);return(...t)=>{n.current&&window.clearTimeout(n.current),n.current=window.setTimeout(()=>e(...t),350)}}(async()=>{let a=s.getCenter(),l=Math.max(2,Math.min(25,Math.round(function(e){let t=e.getSouthWest(),n=e.getNorthEast(),r=(n.lat-t.lat)*Math.PI/180,a=(n.lng-t.lng)*Math.PI/180,o=Math.sin(r/2)**2+Math.cos(t.lat*Math.PI/180)*Math.cos(n.lat*Math.PI/180)*Math.sin(a/2)**2;return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6371/2}(s.getBounds()))));if(n>=13&&r){let t=`/api/stations?lat=${a.lat.toFixed(5)}&lon=${a.lng.toFixed(5)}&radiusKm=${l}`,n=await fetch(t,{cache:"no-store"}),r=await n.json();e((Array.isArray(r)?r:[]).map(m).filter(Boolean))}else e([]);if(o){let e=`/api/heatmap?lat=${a.lat.toFixed(5)}&lon=${a.lng.toFixed(5)}&radiusKm=${l}`,n=await fetch(e,{cache:"no-store"}),r=await n.json();t(Array.isArray(r)?r:[])}else t([])},0);return(0,a.useEffect)(()=>{let e=()=>d();return s.on("moveend",e),s.on("zoomend",e),d(),l({attach:()=>{s.on("moveend",e),s.on("zoomend",e)},detach:()=>{s.off("moveend",e),s.off("zoomend",e)}}),()=>{s.off("moveend",e),s.off("zoomend",e)}},[s,n,r,o]),null},g=()=>{let[e,t]=(0,a.useState)([]),[o,l]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[m,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)([51.5072,-.1276]),[j,w]=(0,a.useState)(12),[v,P]=(0,a.useState)(null),[M,C]=(0,a.useState)(!1),N=(0,a.useRef)(null),S=(0,a.useRef)(null),k=(0,a.useRef)(null),F=(0,a.useRef)(null),A=async e=>{S.current=e;let t=await n.e(52).then(n.t.bind(n,8052,23));await n.e(47).then(n.t.bind(n,4047,23)),k.current=t,e.getPane("overlay-councils")||(e.createPane("overlay-councils"),e.getPane("overlay-councils").style.zIndex=300),e.getPane("heatmap")||(e.createPane("heatmap"),e.getPane("heatmap").style.zIndex=350),e.on("zoomend",()=>{w(e.getZoom()),C(13>e.getZoom())}),e.on("moveend",()=>{let t=e.getCenter();y([t.lat,t.lng])}),w(e.getZoom()),C(13>e.getZoom()),y([e.getCenter().lat,e.getCenter().lng]),document.getElementById("markersBtn")?.addEventListener("click",()=>i(e=>!e)),document.getElementById("heatBtn")?.addEventListener("click",()=>g(e=>!e))},E=async(e,t=14)=>{let n=S.current;n&&(e?(n.setView([e.lat,e.lng],Math.max(t,14)),P(e),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>P(null),6e3)):navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>n.setView([e.coords.latitude,e.coords.longitude],13),()=>alert("Location permission denied")))};(0,a.useEffect)(()=>()=>{F.current&&clearTimeout(F.current)},[]);let _=(0,a.useMemo)(()=>s&&j>=13?e:[],[s,e,j]);return(0,r.jsxs)("div",{className:"w-full h-[calc(100vh-64px)] relative",children:[r.jsx(p,{onLocate:E}),M&&r.jsx("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 bg-black/80 text-white px-4 py-2 rounded-xl z-[1000] text-sm shadow",children:"Zoom in to see markers"}),(0,r.jsxs)(d,{center:b,zoom:j,style:{height:"100%",width:"100%"},whenCreated:e=>A(e),children:[r.jsx(f,{onReady:A}),r.jsx(c,{attribution:"\xa9 OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.jsx(x,{setStations:t,setHeatData:l,zoom:j,showMarkers:s,showHeat:m,onToggleWires:e=>N.current=e}),_.map((e,t)=>r.jsx(u,{center:[e.lat,e.lon],radius:6,fillOpacity:.85,children:r.jsx(h,{children:(0,r.jsxs)("div",{style:{minWidth:220},children:[r.jsx("b",{children:e.name??"Charging site"}),r.jsx("div",{children:e.postcode??e.addr??""}),(0,r.jsxs)("div",{children:["Max power: ",e.maxPowerKw??0," kW"]}),(0,r.jsxs)("div",{children:["Connectors: ",e.connectors??0]}),(0,r.jsxs)("div",{children:["Score: ",(e.score??0).toFixed(2)]}),r.jsx("i",{children:"Feedback coming soon"})]})})},`${e.lat},${e.lon},${t}`)),v&&r.jsx(u,{center:[v.lat,v.lng],radius:10,fillOpacity:.7,color:"#00f"})]})]})}},725:(e,t,n)=>{"use strict";n.d(t,{Footer:()=>a});var r=n(326);function a(){return r.jsx("footer",{className:"border-t mt-10",children:(0,r.jsxs)("div",{className:"container py-8 text-xs text-gray-500 flex flex-col md:flex-row items-center justify-between gap-2",children:[(0,r.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Autodun — EV Finder MVP"]}),(0,r.jsxs)("p",{children:["Charging location data \xa9"," ",r.jsx("a",{href:"https://openchargemap.org",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Open Charge Map"})," ","(CC BY 4.0). Map \xa9"," ",r.jsx("a",{href:"https://www.openstreetmap.org/copyright",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"OpenStreetMap"})," ","contributors."]})]})})}},3353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=n(1174);n(326),n(7577);let a=r._(n(7028));function o(e,t){var n;let r={loading:e=>{let{error:t,isLoading:n,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let o={...r,...t};return(0,a.default)({...o,modules:null==(n=o.loadableGenerated)?void 0:n.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=n(4129);function a(e){let{reason:t,children:n}=e;throw new r.BailoutToCSRError(t)}},7028:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let r=n(326),a=n(7577),o=n(933),l=n(6618);function s(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},d=function(e){let t={...i,...e},n=(0,a.lazy)(()=>t.loader().then(s)),d=t.loading;function c(e){let s=d?(0,r.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,i=t.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.PreloadCss,{moduleIds:t.modules}),(0,r.jsx)(n,{...e})]}):(0,r.jsx)(o.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(n,{...e})});return(0,r.jsx)(a.Suspense,{fallback:s,children:i})}return c.displayName="LoadableComponent",c}},6618:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return o}});let r=n(326),a=n(5403);function o(e){let{moduleIds:t}=e,n=(0,a.getExpectedRequestStore)("next/dynamic css"),o=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));o.push(...t)}}return 0===o.length?null:(0,r.jsx)(r.Fragment,{children:o.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},5832:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m,metadata:()=>u,viewport:()=>h});var r=n(9510);n(8147),n(7272);var a=n(7371);function o(){return r.jsx("header",{className:"border-b bg-white/80 backdrop-blur",children:(0,r.jsxs)("div",{className:"container flex items-center justify-between py-4",children:[(0,r.jsxs)(a.default,{href:"/",className:"flex items-center gap-3",children:[r.jsx("img",{src:"/logo.svg",alt:"Autodun",className:"h-8 w-8"}),r.jsx("span",{className:"text-xl font-extrabold",children:"Autodun"})]}),(0,r.jsxs)("nav",{className:"flex items-center gap-6 text-sm font-semibold",children:[r.jsx(a.default,{href:"/ev",className:"hover:text-autodun-green",children:"EV Finder"}),r.jsx("a",{href:"mailto:info@autodun.com",className:"px-4 py-2 rounded-2xl bg-autodun-green text-white shadow-soft",children:"Contact"})]})]})})}var l=n(8570);let s=(0,l.createProxy)(String.raw`/workspaces/autodun-ev-finder/components/Footer.tsx`),{__esModule:i,$$typeof:d}=s;s.default;let c=(0,l.createProxy)(String.raw`/workspaces/autodun-ev-finder/components/Footer.tsx#Footer`),u={title:"Autodun — EV Charging Finder",description:"Find EV charging stations in the UK by postcode or your current location.",icons:{icon:"/favicon.ico"},metadataBase:new URL("https://autodun.com"),alternates:{canonical:"https://autodun.com"},robots:{index:!0,follow:!0},openGraph:{title:"Autodun — EV Charging Finder",description:"Find EV chargers near you fast.",type:"website",url:"https://autodun.com"}},h={themeColor:"#38bdf8"};function m({children:e}){return r.jsx("html",{lang:"en",children:(0,r.jsxs)("body",{className:"min-h-screen flex flex-col",children:[r.jsx(o,{}),r.jsx("main",{className:"flex-1",children:e}),r.jsx(c,{})]})})}},7272:()=>{}};